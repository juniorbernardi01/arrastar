<!DOCTYPE html>
<html lang="pt-br">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Ranking DISC – Grupo Compacto Premium</title>

<style>
    body {
        font-family: Arial, sans-serif;
        background: #f3f4f6;
        padding: 12px;
    }

    h2 {
        color: #1B4B8C;
        text-align: center;
        margin: 4px 0;
        font-size: 18px;
    }

    .subtexto {
        text-align: center;
        font-size: 13px;
        color: #555;
        margin-bottom: 10px;
    }

    .container-ranking {
        border: 2px solid #1B4B8C;
        background: #ffffff;
        border-radius: 10px;
        padding: 10px;
        margin-bottom: 15px;
    }

    .slot {
        background: #f5f7ff;
        border: 2px dashed #9bb1ff;
        border-radius: 8px;
        padding: 6px 8px;
        min-height: 44px;
        margin-bottom: 6px;
        display: flex;
        align-items: center;
        font-size: 13px;
        color: #555;
        box-sizing: border-box;
    }

    .slot:last-child {
        margin-bottom: 0;
    }

    .slot-label {
        font-weight: bold;
        color: #1B4B8C;
        font-size: 12px;
        margin-right: 6px;
        white-space: nowrap;
        flex-shrink: 0;
    }

    .slot-text {
        font-size: 12px;
        color: #666;
    }

    .slot.filled {
        border-style: solid;
        border-color: #1B4B8C;
        background: #e6edff;
        color: #1B4B8C;
        font-weight: bold;
    }

    /* Lista de adjetivos */
    .adjetivos-titulo {
        font-size: 14px;
        color: #1B4B8C;
        margin: 6px 0 6px 4px;
        font-weight: bold;
    }

    .adjetivos-lista {
        margin-top: 4px;
    }

    .adjetivo-card {
        background: #ffffff;
        padding: 6px 8px;
        border-radius: 8px;
        margin-bottom: 6px;
        font-size: 13px;
        display: flex;
        align-items: center;
        gap: 6px;
        cursor: grab;
        box-shadow: 0 2px 4px rgba(0,0,0,0.08);
        transition: transform 0.1s ease;
    }

    .adjetivo-card:active {
        transform: scale(1.02);
        cursor: grabbing;
    }

    .handle {
        font-size: 18px;
        color: #333;
        flex-shrink: 0;
    }

    /* Fantasma do card quando segue o dedo no celular */
    .drag-ghost {
        position: fixed;
        z-index: 9999;
        max-width: 92%;
        padding: 6px 8px;
        background: #ffffff;
        border-radius: 8px;
        box-shadow: 0 5px 10px rgba(0,0,0,0.25);
        pointer-events: none;
        opacity: 0.95;
        transform: translate(-50%, -50%);
        font-size: 13px;
        display: flex;
        align-items: center;
        gap: 6px;
    }

    @media (min-width: 768px){
        body {
            max-width: 480px;
            margin: 0 auto;
        }
    }
</style>
</head>

<body>

<!-- Barra de progresso -->
<h2>1 de 10</h2>
<div style="
    width: 100%;
    height: 6px;
    background: #dbe3f5;
    border-radius: 4px;
    margin-bottom: 10px;
    overflow: hidden;">
    <div id="progressBar" style="
        width: 10%;
        height: 100%;
        background: #1B4B8C;
        border-radius: 4px;">
    </div>
</div>

<div class="subtexto">
    Arraste os adjetivos <b>de baixo</b> para as caixas <b>acima</b>.<br>
    <b>Topo = mais parecido com você</b> &mdash; <b>Última caixa = menos parecido</b>.
</div>

<div class="container-ranking" id="ranking">
    <div class="slot" data-pos="1">
        <span class="slot-label">1º</span>
        <span class="slot-text">O que MAIS se parece com você</span>
    </div>
    <div class="slot" data-pos="2">
        <span class="slot-label">2º</span>
        <span class="slot-text">O segundo mais parecido</span>
    </div>
    <div class="slot" data-pos="3">
        <span class="slot-label">3º</span>
        <span class="slot-text">O terceiro mais parecido</span>
    </div>
    <div class="slot" data-pos="4">
        <span class="slot-label">4º</span>
        <span class="slot-text">O que MENOS se parece com você</span>
    </div>
</div>

<div class="adjetivos-titulo">Adjetivos disponíveis (arraste para as caixas acima):</div>

<div class="adjetivos-lista" id="lista">
    <div class="adjetivo-card" draggable="true" data-id="0">
        <span class="handle">☰</span>
        <span>Autoconfiante / Independente / Dominante</span>
    </div>
    <div class="adjetivo-card" draggable="true" data-id="1">
        <span class="handle">☰</span>
        <span>Comunicativo / Alegre / Extrovertido</span>
    </div>
    <div class="adjetivo-card" draggable="true" data-id="2">
        <span class="handle">☰</span>
        <span>Acolhedor / Amigável / Paciente</span>
    </div>
    <div class="adjetivo-card" draggable="true" data-id="3">
        <span class="handle">☰</span>
        <span>Autodisciplinado / Detalhista / Diligente</span>
    </div>
</div>

<script>
let draggingCard = null;
let ghost = null;

const lista = document.getElementById("lista");
const slots = Array.from(document.querySelectorAll(".slot"));

/* ---------- Helpers de ranking ---------- */

function resetSlotPlaceholder(slot) {
    const pos = slot.getAttribute("data-pos");
    const textEl = slot.querySelector(".slot-text");
    if (!textEl) return;
    if (pos === "1") textEl.textContent = "O que MAIS se parece com você";
    else if (pos === "2") textEl.textContent = "O segundo mais parecido";
    else if (pos === "3") textEl.textContent = "O terceiro mais parecido";
    else if (pos === "4") textEl.textContent = "O que MENOS se parece com você";
    textEl.style.display = "inline";
    slot.classList.remove("filled");
}

function getCurrentOrder() {
    const order = [];
    slots.forEach(slot => {
        const card = slot.querySelector(".adjetivo-card");
        if (card) order.push(card);
    });
    return order;
}

function applyOrder(order) {
    // devolve todos os cards dos slots pra lista temporariamente
    slots.forEach(slot => {
        const card = slot.querySelector(".adjetivo-card");
        if (card) lista.appendChild(card);
        resetSlotPlaceholder(slot);
    });

    // coloca os cards na ordem nos slots 1..4
    order.forEach((card, idx) => {
        if (idx >= slots.length) return;
        const slot = slots[idx];
        slot.appendChild(card);
        slot.classList.add("filled");
        const textEl = slot.querySelector(".slot-text");
        if (textEl) textEl.style.display = "none";
        card.style.display = "flex";
    });
}

function insertCardAtIndex(card, targetIndex) {
    let current = getCurrentOrder();
    // remove se já estava no ranking (reordenar)
    current = current.filter(c => c !== card);

    if (targetIndex < 0) targetIndex = 0;
    if (targetIndex > current.length) targetIndex = current.length;

    current.splice(targetIndex, 0, card);
    const finalOrder = current.slice(0, slots.length);
    applyOrder(finalOrder);
}

function moveFromRankToList(card) {
    const current = getCurrentOrder();
    const newOrder = current.filter(c => c !== card);
    applyOrder(newOrder);
    lista.appendChild(card);
    card.style.display = "flex";
}

/* ---------- Drag mobile (touch) ---------- */

document.querySelectorAll(".adjetivo-card").forEach(card => {
    card.addEventListener("touchstart", e => {
        draggingCard = card;

        ghost = card.cloneNode(true);
        ghost.classList.add("drag-ghost");
        document.body.appendChild(ghost);

        card.style.opacity = "0.3";

        const touch = e.touches[0];
        ghost.style.left = touch.clientX + "px";
        ghost.style.top = touch.clientY + "px";
    }, { passive: true });

    card.addEventListener("touchmove", e => {
        if (!ghost) return;
        e.preventDefault();

        const touch = e.touches[0];
        ghost.style.left = touch.clientX + "px";
        ghost.style.top = touch.clientY + "px";
    }, { passive: false });

    card.addEventListener("touchend", e => {
        if (!draggingCard) return;

        draggingCard.style.opacity = "1";

        const touch = e.changedTouches[0];
        const elem = document.elementFromPoint(touch.clientX, touch.clientY);

        const slot = elem ? elem.closest(".slot") : null;
        const listaDrop = elem ? elem.closest("#lista") : null;

        if (slot) {
            const targetIndex = slots.indexOf(slot);
            insertCardAtIndex(draggingCard, targetIndex);
        } else if (listaDrop) {
            moveFromRankToList(draggingCard);
        }

        if (ghost) {
            ghost.remove();
            ghost = null;
        }
        draggingCard = null;
    });
});

/* ---------- Drag desktop ---------- */

document.querySelectorAll(".adjetivo-card").forEach(card => {
    card.addEventListener("dragstart", () => {
        draggingCard = card;
        setTimeout(() => card.style.opacity = "0.3", 0);
    });

    card.addEventListener("dragend", () => {
        if (draggingCard) draggingCard.style.opacity = "1";
        draggingCard = null;
    });
});

slots.forEach(slot => {
    slot.addEventListener("dragover", e => e.preventDefault());

    slot.addEventListener("drop", () => {
        if (!draggingCard) return;
        const targetIndex = slots.indexOf(slot);
        insertCardAtIndex(draggingCard, targetIndex);
    });

    // clique no slot devolve o card para a lista
    slot.addEventListener("click", () => {
        const card = slot.querySelector(".adjetivo-card");
        if (card) moveFromRankToList(card);
    });
});

// lista aceita soltar card para tirar do ranking
lista.addEventListener("dragover", e => e.preventDefault());
lista.addEventListener("drop", () => {
    if (!draggingCard) return;
    moveFromRankToList(draggingCard);
});
</script>

</body>
</html>
